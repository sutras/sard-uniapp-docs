import{E as e,d as a,p as l,g as s,U as n,A as t,z as u,a3 as r,q as c,s as o,o as i,f as d,w as m,e as v,h as f,u as y,c as p,F as h,b as g,i as A,t as b,y as _,Z as k,a4 as j,l as V,a5 as x,a6 as C}from"./index-6f8f5948.js";import{b as w,_ as I}from"./index.09d87181.js";const S={rootStyle:[String,Object,Array],rootClass:String,columns:{type:Array,default:()=>[]},optionKeys:Object,modelValue:null,immediateChange:{type:Boolean,default:e.picker.immediateChange}},M={label:"label",value:"value",children:"children"};function O(e,a){const l=e[0];return Array.isArray(l)?"multi":l&&"object"==typeof l&&Array.isArray(l[a.children])?"cascader":"single"}function K(e,a){return null!==e&&"object"!=typeof e?e:e[a]}function q(e,a,l){switch(O(a,l)){case"single":return[a[e[0]]];case"multi":return a.map(((a,l)=>a[e[l]]));case"cascader":return function a(s,n=0){const t=s[Math.min(e[n],s.length-1)],u=null==t?void 0:t[l.children];return Array.isArray(u)?[t,...a(u,++n)]:[t]}(a)}}function z(e,a,l){const s=function(e,a){return e.map((e=>K(e,a)))}(e,a.value);return"single"===O(l,a)?s[0]:s}function B(e,a,l){const s=O(a,l);return"cascader"===s?function a(s,n=0){let t=s.findIndex((a=>a[l.value]===e[n]));-1===t&&(t=0);const u=s[t],r=null==u?void 0:u[l.children];return Array.isArray(r)?[t,...a(r,++n)]:[t]}(a):("single"===s&&(a=[a]),a.map(((a,s)=>{const n=a.findIndex((a=>K(a,l.value)===e[s]));return Math.max(n,0)})))}function E(e,a){switch(O(e,a)){case"single":return K(e[0],a.value);case"multi":return e.map((e=>K(e[0],a.value)));case"cascader":return K(function e(l){const s=l[0],n=null==s?void 0:s[a.children];return Array.isArray(n)&&n.length>0?e(n):s}(e),a.value)}}const F=I(a({options:{virtualHost:!0,styleIsolation:"shared"},__name:"picker",props:S,emits:["update:model-value"],setup(e,{emit:a}){const I=e,S=w("picker"),E=l((()=>Object.assign({},M,I.optionKeys))),F=l((()=>O(I.columns,E.value))),H=s(I.modelValue),U=s(B(n(H.value),I.columns,E.value));t((()=>I.modelValue),(()=>{if(H.value=I.modelValue,!u(I.modelValue)&&""!==I.modelValue){const e=B(n(I.modelValue),I.columns,E.value);r(e,U.value)||(U.value=e)}}));const Z=e=>{let l=e.detail.value;if(l.some((e=>e===1/0)))return void k((()=>{U.value=u(H.value)||""===H.value?U.value.map((()=>0)):[...U.value]}));if("cascader"===F.value){let e=-1;const a=[];for(let s=0;s<U.value.length;s++)e<0&&U.value[s]!==l[s]&&(e=s),a.push(e>-1&&s>e?0:l[s]);l=a;{const e=function(e,a,l){return function a(s,n=0){let t=Math.min(e[n],s.length-1);const u=s[t];u||(t=0);const r=null==u?void 0:u[l.children];return Array.isArray(r)?[t,...a(r,++n)]:[t]}(a)}(l,I.columns,E.value);r(l,e)||(l=e)}}const s=q(l,I.columns,E.value);r(l,U.value)||(U.value=l);const n=z(s,E.value,I.columns);H.value=n,a("update:model-value",n,s,l)},D=()=>{switch(F.value){case"single":return[I.columns];case"multi":return I.columns;case"cascader":return j(I.columns,n(H.value),E.value);default:return[]}},G=s(D());t([()=>I.columns,H],(([e,a],[l,s])=>{(e!==l||a!==s&&"cascader"===F.value&&!u(a)&&""!==a&&(!Array.isArray(a)||a.length>0))&&(G.value=D())}));const J=e=>K(e,E.value.label),L=l((()=>c(S.b(),I.rootClass))),N=l((()=>o(I.rootStyle)));return(e,a)=>{const l=V,s=x,n=C;return i(),d(l,{class:f(y(L)),style:_(y(N))},{default:m((()=>[v(n,{class:f(y(S).e("picker-view")),"indicator-class":y(S).e("indicator"),"mask-class":y(S).e("mask"),value:U.value,"immediate-change":e.immediateChange,onChange:Z},{default:m((()=>[(i(!0),p(h,null,g(G.value,((e,a)=>(i(),d(s,{key:a},{default:m((()=>[(i(!0),p(h,null,g(e,((e,a)=>(i(),d(l,{key:a,class:f(y(S).e("item"))},{default:m((()=>[A(b(J(e)),1)])),_:2},1032,["class"])))),128))])),_:2},1024)))),128))])),_:1},8,["class","indicator-class","mask-class","value","immediate-change"])])),_:1},8,["class","style"])}}}),[["__scopeId","data-v-55239219"]]);export{F as _,B as a,q as b,K as c,M as d,E as g,S as p};
