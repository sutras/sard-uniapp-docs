import{d as e,p as a,g as l,a3 as s,A as n,z as t,a4 as u,q as r,s as c,o,f as i,w as d,e as m,h as v,u as f,c as p,F as y,b as h,i as g,t as A,y as b,Z as _,a5 as j,l as k,a6 as x,a7 as V}from"./index-9377a170.js";import{a as w}from"./index.fad96fb0.js";import{_ as C}from"./_plugin-vue_export-helper.1b428a4d.js";const I={rootStyle:[String,Object,Array],rootClass:String,columns:{type:Array,default:()=>[]},optionKeys:Object,modelValue:null,immediateChange:{type:Boolean,default:!1}},S={label:"label",value:"value",children:"children"};function M(e,a){const l=e[0];return Array.isArray(l)?"multi":l&&"object"==typeof l&&Array.isArray(l[a.children])?"cascader":"single"}function O(e,a){return null!==e&&"object"!=typeof e?e:e[a]}function K(e,a,l){switch(M(a,l)){case"single":return[a[e[0]]];case"multi":return a.map(((a,l)=>a[e[l]]));case"cascader":return function a(s,n=0){const t=s[Math.min(e[n],s.length-1)],u=null==t?void 0:t[l.children];return Array.isArray(u)?[t,...a(u,++n)]:[t]}(a)}}function q(e,a,l){const s=function(e,a){return e.map((e=>O(e,a)))}(e,a.value);return"single"===M(l,a)?s[0]:s}function z(e,a,l){const s=M(a,l);return"cascader"===s?function a(s,n=0){let t=s.findIndex((a=>a[l.value]===e[n]));-1===t&&(t=0);const u=s[t],r=null==u?void 0:u[l.children];return Array.isArray(r)?[t,...a(r,++n)]:[t]}(a):("single"===s&&(a=[a]),a.map(((a,s)=>{const n=a.findIndex((a=>O(a,l.value)===e[s]));return Math.max(n,0)})))}function B(e,a){switch(M(e,a)){case"single":return O(e[0],a.value);case"multi":return e.map((e=>O(e[0],a.value)));case"cascader":return O(function e(l){const s=l[0],n=null==s?void 0:s[a.children];return Array.isArray(n)&&n.length>0?e(n):s}(e),a.value)}}const F=C(e({options:{virtualHost:!0,styleIsolation:"shared"},__name:"picker",props:I,emits:["update:model-value"],setup(e,{emit:C}){const I=e,B=w("picker"),F=a((()=>Object.assign({},S,I.optionKeys))),H=a((()=>M(I.columns,F.value))),Z=l(I.modelValue),D=l(z(s(Z.value),I.columns,F.value));n((()=>I.modelValue),(()=>{if(Z.value=I.modelValue,!t(I.modelValue)&&""!==I.modelValue){const e=z(s(I.modelValue),I.columns,F.value);u(e,D.value)||(D.value=e)}}));const E=e=>{let a=e.detail.value;if(a.some((e=>e===1/0)))return void _((()=>{D.value=t(Z.value)||""===Z.value?D.value.map((()=>0)):[...D.value]}));if("cascader"===H.value){let e=-1;const l=[];for(let s=0;s<D.value.length;s++)e<0&&D.value[s]!==a[s]&&(e=s),l.push(e>-1&&s>e?0:a[s]);a=l;{const e=function(e,a,l){return function a(s,n=0){let t=Math.min(e[n],s.length-1);const u=s[t];u||(t=0);const r=null==u?void 0:u[l.children];return Array.isArray(r)?[t,...a(r,++n)]:[t]}(a)}(a,I.columns,F.value);u(a,e)||(a=e)}}const l=K(a,I.columns,F.value);u(a,D.value)||(D.value=a);const s=q(l,F.value,I.columns);Z.value=s,C("update:model-value",s,l,a)},G=()=>{switch(H.value){case"single":return[I.columns];case"multi":return I.columns;case"cascader":return j(I.columns,s(Z.value),F.value);default:return[]}},J=l(G());n([()=>I.columns,Z],(([e,a],[l,s])=>{(e!==l||a!==s&&"cascader"===H.value&&!t(a)&&""!==a&&(!Array.isArray(a)||a.length>0))&&(J.value=G())}));const L=e=>O(e,F.value.label),N=a((()=>r(B.b(),I.rootClass))),P=a((()=>c(I.rootStyle)));return(e,a)=>{const l=k,s=x,n=V;return o(),i(l,{class:v(f(N)),style:b(f(P))},{default:d((()=>[m(n,{class:v(f(B).e("picker-view")),"indicator-class":f(B).e("indicator"),"mask-class":f(B).e("mask"),value:D.value,"immediate-change":e.immediateChange,onChange:E},{default:d((()=>[(o(!0),p(y,null,h(J.value,((e,a)=>(o(),i(s,{key:a},{default:d((()=>[(o(!0),p(y,null,h(e,((e,a)=>(o(),i(l,{key:a,class:v(f(B).e("item"))},{default:d((()=>[g(A(L(e)),1)])),_:2},1032,["class"])))),128))])),_:2},1024)))),128))])),_:1},8,["class","indicator-class","mask-class","value","immediate-change"])])),_:1},8,["class","style"])}}}),[["__scopeId","data-v-fbd17525"]]);export{F as _,z as a,K as b,O as c,S as d,B as g,I as p};
