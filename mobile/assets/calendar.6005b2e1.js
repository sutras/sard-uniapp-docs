import{E as e,d as a,p as t,s as l,q as s,o as r,f as n,w as u,h as o,i as d,t as m,v as i,e as y,c,F as v,b as p,u as f,y as b,l as h,T as D,g,A as _,U as k,V as w}from"./index-aa8abc65.js";import{_ as x,a as M,b as S}from"./index.776be883.js";import{g as F,a as A,b as q,c as N,d as V,t as C,m as O,e as j,_ as Y,h as T,i as I}from"./datetime-picker.vue_vue_type_script_setup_true_lang.f6e8ecb1.js";import{u as B}from"./index.5a4c2473.js";import{_ as U}from"./button.21fa86db.js";import{_ as $}from"./popout.83744114.js";const z={rootStyle:[String,Object,Array],rootClass:String,type:{type:String,default:e.calendar.type},modelValue:[Date,Array],min:Date,max:Date,currentDate:Date,disabledDate:Function,maxDays:{type:Number,default:e.calendar.maxDays},overMaxDays:Function,weekStartsOn:{type:Number,default:e.calendar.weekStartsOn},formatter:Function,allowSameDay:Boolean,severalMonths:Boolean},H={year:{type:Number,required:!0},month:{type:Number,required:!0},type:{type:String,required:!0},minDate:{type:Date,required:!0},maxDate:{type:Date,required:!0},currentDates:{type:Array,required:!0},formatter:Function,disabledDate:Function,todayNumber:{type:Number,required:!0},weekStartsOn:{type:Number,required:!0},severalMonths:Boolean,t:{type:Function,required:!0},bem:{type:Object,required:!0}},E=[0,1,2,3,4,5,6],L=x(a({options:{virtualHost:!0,styleIsolation:"shared"},__name:"calendar-month",props:H,emits:["day-click"],setup(e,{emit:a}){const D=e,g=t((()=>F(D.year,D.month))),_=t((()=>A(q(D.year,D.month),D.weekStartsOn))),k=t((()=>{const e=Array(g.value).fill(0).map(((e,a)=>new Date(D.year,D.month,a+1)));if(D.severalMonths)return e;const a=N(D.year,D.month,_.value),t=V(D.year,D.month,42-_.value-g.value);return[...a,...e,...t]}));const w={same:"same",start:"start",middle:"middle",end:"end",selected:"selected",normal:"normal"},x=t((()=>k.value.map(((e,a)=>{const t=C(e),r=function(e){return!!D.severalMonths||e>=_.value&&e<_.value+g.value}(a);let n=!1;r?(D.disabledDate&&(n=D.disabledDate(e)),(t<C(D.minDate)||t>C(D.maxDate))&&(n=!0)):n=!0;const u=r&&"range"!==D.type&&D.currentDates.some((e=>C(e)===t)),o=r&&"range"===D.type&&D.currentDates[0]&&C(D.currentDates[0])===t,d=r&&"range"===D.type&&D.currentDates[1]&&C(D.currentDates[1])===t,m=r&&"range"===D.type&&2===D.currentDates.length&&t>C(D.currentDates[0])&&t<C(D.currentDates[1]),i={date:e,disabled:n,top:"",text:e.getDate()+"",bottom:o&&d?`${D.t("start")}/${D.t("end")}`:o?D.t("start"):d?D.t("end"):"",type:o&&d?"same":o?"start":m?"middle":d?"end":u?"selected":"normal"};r&&D.formatter&&D.formatter(i);const y=w[i.type];return{day:i,style:l(i.style,{marginLeft:D.severalMonths&&0===a?_.value/7*100+"%":null}),className:s(D.bem.e("day"),D.bem.em("day",y,"normal"!==y),D.bem.em("day","without",!r),D.bem.em("day","disabled",n),D.bem.em("day","today",D.todayNumber===t),i.className)}}))));return(e,t)=>{const l=h;return r(),n(l,{class:o(e.bem.e("month"))},{default:u((()=>[e.severalMonths?(r(),n(l,{key:0,class:o(e.bem.e("month-title"))},{default:u((()=>[d(m(e.t("monthTitle",{year:e.year,month:e.month+1})),1)])),_:1},8,["class"])):i("",!0),y(l,{class:o(e.bem.e("days"))},{default:u((()=>[(r(!0),c(v,null,p(f(x),((t,s)=>(r(),n(l,{key:s,class:o(t.className),style:b(t.style),onClick:e=>{var l;(l=t.day).disabled||a("day-click",l.date)}},{default:u((()=>[t.day.top?(r(),n(l,{key:0,class:o(e.bem.e("top"))},{default:u((()=>[d(m(t.day.top),1)])),_:2},1032,["class"])):i("",!0),d(" "+m(t.day.text)+" ",1),t.day.bottom?(r(),n(l,{key:1,class:o(e.bem.e("bottom"))},{default:u((()=>[d(m(t.day.bottom),1)])),_:2},1032,["class"])):i("",!0)])),_:2},1032,["class","style","onClick"])))),128)),y(l,{class:o(e.bem.e("mark"))},{default:u((()=>[d(m(e.month+1),1)])),_:1},8,["class"])])),_:1},8,["class"])])),_:1},8,["class"])}}}),[["__scopeId","data-v-930f8a0e"]]),G=x(a({options:{virtualHost:!0,styleIsolation:"shared"},__name:"calendar",props:z,emits:["update:model-value"],setup(e,{emit:a}){const x=e,F=S("calendar"),{t:A}=D("calendar"),q=t((()=>x.min||(e=>{const a=new Date;return e?new Date(a.getFullYear(),a.getMonth(),1):new Date(a.getFullYear()-10,0,1)})(x.severalMonths))),N=t((()=>{const e=x.max||(e=>{const a=new Date;return e?new Date(a.getFullYear(),a.getMonth()+3,0):new Date(a.getFullYear()+10,11,31)})(x.severalMonths);return e.getTime()<q.value.getTime()?new Date(q.value):e})),V=g(x.modelValue??("single"===x.type?void 0:[]));_((()=>x.modelValue),(()=>{V.value!==x.modelValue&&(V.value=x.modelValue??("single"===x.type?void 0:[]))}));const z=g((()=>{let e=new Date;const a=k(x.modelValue)[0];return a&&(e=a),x.currentDate&&(e=x.currentDate),O(e,q.value,N.value)})());_((()=>x.currentDate),(()=>{z.value=O(x.currentDate||new Date,q.value,N.value)})),_(V,(()=>{const e=Array.isArray(V.value)?1===V.value.length?V.value[0]:void 0:V.value;e&&j(e)!==j(z.value)&&(z.value=e)}));const H=g("range"===x.type&&Array.isArray(V.value)&&1===V.value.length?V.value[0]:void 0),G=()=>{z.value=T(z.value)},J=()=>{z.value=I(z.value)},K=g(!1),P=g(z.value),Q=()=>{P.value=z.value,K.value=!0},R=()=>{j(z.value)!==j(P.value)&&(z.value=P.value)},W=t((()=>E.slice(x.weekStartsOn).concat(E.slice(0,x.weekStartsOn)))),X=t((()=>{if(!x.severalMonths)return[[z.value.getFullYear(),z.value.getMonth()]];const e=q.value.getFullYear(),a=q.value.getMonth(),t=N.value.getFullYear(),l=N.value.getMonth();return Array(12*(t-e)+(l-a+1)).fill(0).map(((t,l)=>[e+Math.floor((a+l)/12),(a+l)%12]))})),Z=C(new Date),ee=t((()=>{let e;return e="range"===x.type&&H.value?[H.value]:Array.isArray(V.value)?V.value:V.value?[V.value]:[],e})),ae=e=>{var t,l;let s;if("single"===x.type)s=e;else if("multiple"===x.type){if(Array.isArray(V.value))if(V.value.some((a=>C(a)===C(e))))s=V.value.filter((a=>C(a)!==C(e)));else{if(V.value.length>=x.maxDays)return void(null==(t=x.overMaxDays)||t.call(x));s=V.value.concat(e).sort(((e,a)=>e.getTime()-a.getTime()))}}else if("range"===x.type){if(H.value){const a=C(H.value),t=C(e);if(!x.allowSameDay&&a===t)return;if(t<a)return void(H.value=e);let r=e;t-a+1>x.maxDays&&(null==(l=x.overMaxDays)||l.call(x),r=new Date(H.value),r.setDate(r.getDate()+(x.maxDays-1))),s=[H.value,r]}else s=[];H.value=H.value?void 0:e}void 0!==s&&(V.value=s,a("update:model-value",s))},te=B(),le=t((()=>te&&!x.severalMonths)),se=t((()=>s(F.b(),F.m("several",x.severalMonths),F.m("no-scroll",le.value),x.rootClass))),re=t((()=>l(x.rootStyle)));return(e,a)=>{const t=h,l=w;return r(),c(v,null,[y(t,{class:o(f(se)),style:b(f(re))},{default:u((()=>[y(t,{class:o(f(F).e("header"))},{default:u((()=>[e.severalMonths?i("",!0):(r(),n(t,{key:0,class:o(f(F).e("toolbar"))},{default:u((()=>[y(t,{class:o(f(F).e("toolbar-inner"))},{default:u((()=>[y(U,{type:"pale-text",theme:"neutral",disabled:f(j)(z.value)<=f(j)(f(q)),onClick:G},{default:u((()=>[y(M,{name:"left",size:"32rpx"})])),_:1},8,["disabled"]),y(U,{type:"pale-text",theme:"neutral",onClick:Q},{default:u((()=>[d(m(f(A)("monthTitle",{year:z.value.getFullYear(),month:String(z.value.getMonth()+1).padStart(2,"0")})),1)])),_:1}),y(U,{type:"pale-text",theme:"neutral",disabled:f(j)(z.value)>=f(j)(f(N)),onClick:J},{default:u((()=>[y(M,{name:"right",size:"32rpx"})])),_:1},8,["disabled"])])),_:1},8,["class"])])),_:1},8,["class"])),y(t,{class:o(f(F).e("week"))},{default:u((()=>[(r(!0),c(v,null,p(f(W),((e,a)=>(r(),n(t,{key:a,class:o(f(F).e("week-item"))},{default:u((()=>[d(m(f(A)(`weeks.${e}`)),1)])),_:2},1032,["class"])))),128))])),_:1},8,["class"])])),_:1},8,["class"]),y(l,{"scroll-y":e.severalMonths,class:o(f(F).e("body"))},{default:u((()=>[(r(!0),c(v,null,p(f(X),((a,t)=>(r(),n(L,{key:t,year:a[0],month:a[1],type:e.type,"min-date":f(q),"max-date":f(N),"current-dates":f(ee),formatter:e.formatter,"disabled-date":e.disabledDate,"today-number":f(Z),"week-starts-on":e.weekStartsOn,"several-months":e.severalMonths,t:f(A),bem:f(F),onDayClick:ae},null,8,["year","month","type","min-date","max-date","current-dates","formatter","disabled-date","today-number","week-starts-on","several-months","t","bem"])))),128))])),_:1},8,["scroll-y","class"])])),_:1},8,["class","style"]),e.severalMonths?i("",!0):(r(),n($,{key:0,visible:K.value,"onUpdate:visible":a[1]||(a[1]=e=>K.value=e),type:"compact",onConfirm:R},{default:u((()=>[y(Y,{type:"yM",modelValue:P.value,"onUpdate:modelValue":a[0]||(a[0]=e=>P.value=e),min:f(q),max:f(N)},null,8,["modelValue","min","max"])])),_:1},8,["visible"]))],64)}}}),[["__scopeId","data-v-1194ef0e"]]);export{G as S,z as c};
