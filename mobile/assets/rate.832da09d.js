import{d as e,p as a,g as t,A as l,J as o,q as s,s as n,o as i,f as u,w as r,e as d,h as c,u as v,y as m,Q as f,c as y,F as p,b as h,i as g,t as w,l as S,K as _}from"./index-55845ce0.js";import{_ as b,a as x}from"./index.f4d2668a.js";import{g as k}from"./dom.7fe67c3f.js";import{a as C,u as j}from"./common.bcce75e7.js";import{_ as E}from"./_plugin-vue_export-helper.1b428a4d.js";const T=E(e({options:{virtualHost:!0,styleIsolation:"shared"},__name:"rate",props:{rootStyle:[String,Object,Array],rootClass:String,modelValue:Number,allowHalf:Boolean,clearable:Boolean,count:{type:Number,default:5},size:String,gap:String,iconFamily:String,icon:{type:String,default:"star-fill"},voidIcon:{type:String,default:"star"},text:String,voidText:String,color:String,voidColor:String,disabled:Boolean,readonly:Boolean,validateEvent:{type:Boolean,default:!0}},emits:["update:model-value"],setup(e,{emit:E}){const T=e,B=x("rate"),D=C(),F=j(),H=a((()=>(null==D?void 0:D.disabled)??T.disabled)),I=a((()=>(null==D?void 0:D.readonly)??T.readonly)),L=t(T.modelValue??0);l((()=>T.modelValue),(()=>{L.value=T.modelValue??0,T.validateEvent&&(null==F||F.onChange())}));const V=o(),$=o(),z=_(),A=t(),N=t(),X=a((()=>Array(T.count).fill(0).map(((e,a)=>{const t=a+1-L.value;return{width:100*(t<=0?1:t>1?0:L.value%1)+"%"}})))),q=()=>{I.value||H.value||(k(`#${V}`,z).then((e=>{A.value=e})),k(`#${$}`,z).then((e=>{N.value=e})))},J=e=>{if(I.value||H.value)return;if(e.preventDefault(),!A.value||!N.value)return;const{left:a,width:t}=A.value,{clientX:l}=e.touches[0],o=l-a;let s;if(o<0)s=0;else{const{width:e}=N.value,a=(t-T.count*e)/(T.count-1);for(let t=T.count-1;t>=0;t--){const l=t*(a+e);if(o>=l){s=t+(T.allowHalf&&o<=l+e/2?.5:1);break}}}void 0!==s&&s!==L.value&&(L.value=s,E("update:model-value",s))},K=()=>{q();const e=e=>{e.preventDefault(),J({touches:[e],preventDefault:()=>{e.preventDefault()}})},a=()=>{document.removeEventListener("mouseup",a),document.removeEventListener("mousemove",e)};document.addEventListener("mousemove",e),document.addEventListener("mouseup",a)},M=a((()=>s(B.b(),B.m("disabled",H.value),B.m("readonly",I.value),T.rootClass))),O=a((()=>n(T.rootStyle))),Q=a((()=>n({gap:T.gap})));return(e,a)=>{const t=S;return i(),u(t,{class:c(v(M)),style:m(v(O))},{default:r((()=>[d(t,{class:c(v(B).e("content")),style:m(v(Q)),id:v(V),onTouchstart:q,onTouchmove:f(J,["stop","prevent"]),onMousedown:K},{default:r((()=>[(i(!0),y(p,null,h(v(X),((a,l)=>(i(),u(t,{key:l,class:c(v(B).e("item")),id:0===l?v($):void 0,style:m(v(n)({fontSize:e.size})),onClick:e=>(async(e,a)=>{if(I.value||H.value)return;let t;if(T.allowHalf){const{left:l,width:o}=await k(`#${V}`,z),{width:s}=await k(`#${$}`,z),{clientX:n}="touches"in e?e.touches[0]:e;t=a+(n-l-a*(s+(o-T.count*s)/(T.count-1))<=s/2?.5:1)}else t=a+1;T.clearable&&t===L.value&&(t=0),void 0!==t&&t!==L.value&&(L.value=t,E("update:model-value",t))})(e,l)},{default:r((()=>[d(t,{class:c(v(B).e("star-void")),style:m(v(n)({color:e.voidColor}))},{default:r((()=>[e.voidText?(i(),y(p,{key:0},[g(w(e.voidText),1)],64)):(i(),u(b,{key:1,name:e.voidIcon,family:e.iconFamily},null,8,["name","family"]))])),_:1},8,["class","style"]),d(t,{class:c(v(B).e("star")),style:m(v(n)({color:e.color,width:a.width}))},{default:r((()=>[e.text?(i(),y(p,{key:0},[g(w(e.text),1)],64)):(i(),u(b,{key:1,name:e.icon,family:e.iconFamily},null,8,["name","family"]))])),_:2},1032,["class","style"])])),_:2},1032,["class","id","style","onClick"])))),128))])),_:1},8,["class","style","id","onTouchmove"])])),_:1},8,["class","style"])}}}),[["__scopeId","data-v-0ea67943"]]);export{T as _};
