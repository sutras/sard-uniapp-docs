import{E as e,d as a,G as s,g as o,p as t,A as n,N as l,o as r,f as i,w as u,e as d,h as c,u as v,x as m,v as p,s as h,ar as g,q as y,z as f,l as w}from"./index-GlWSIXJ_.js";import{b as _,_ as b}from"./index.DZ-iMJGl.js";import{t as x}from"./dom.BhynX98V.js";import{e as k,a as D}from"./index.D9XOTfsQ.js";const T={...e.pullDownRefresh,loading:!1,disabled:!1},$=b(a({options:{virtualHost:!0,styleIsolation:"shared"},__name:"pull-down-refresh",props:s({rootStyle:{},rootClass:{},threshold:{},headerHeight:{},loading:{type:Boolean},transitionDuration:{},doneDuration:{},disabled:{type:Boolean}},T),emits:["refresh"],setup(e,{expose:a,emit:s}){const b=e,T=s,$=_("pull-down-refresh"),E=o("initial"),L=o(0),M=t((()=>Math.min(L.value/b.threshold,1))),[j,H]=k((()=>{E.value="initial"})),[I,P]=k((()=>{S()})),R=()=>{P(),H(),E.value="loading",L.value=b.headerHeight},S=()=>{E.value="recovering",L.value=0,j(b.transitionDuration)};n((()=>b.loading),(()=>{b.loading?R():(E.value="done",I(b.doneDuration))})),l((()=>{b.loading&&R()}));let Y=0,B=0,C=!1,X="";const q=o(!1),z=e=>{!b.disabled&&"initial"===E.value&&F.value&&(Y=e.touches[0].clientX,B=e.touches[0].clientY,C=!0)},A=e=>{if(!C||X&&"down"!==X)return;const a=e.touches[0].clientX-Y,s=e.touches[0].clientY-B;if(!X){const e=Math.abs(s)>=Math.abs(a);X=e&&s>0?"down":"others"}if("down"===X){const a=Math.max(s,0)/2;E.value=a>=b.threshold?"ready":"unready",L.value=a,q.value=!0,e.preventDefault(),e.stopImmediatePropagation?e.stopImmediatePropagation():e.stopPropagation&&e.stopPropagation()}},G=()=>{switch(C=!1,X="",q.value=!1,E.value){case"unready":return void S();case"ready":return R(),void T("refresh")}},N=e=>{const a=g();z(x(e,a.windowTop));const s=e=>{A(x(e,a.windowTop))},o=()=>{G(),document.removeEventListener("mouseup",o),document.removeEventListener("mousemove",s)};document.addEventListener("mousemove",s),document.addEventListener("mouseup",o)},F=o(!0);a({enableToRefresh:e=>{F.value=e},_setStatus:e=>{E.value=e},_emit(e){T(e.name)},_toRecovering:S,_toLoading:R,_setTranslateY:e=>{L.value=e}});const J=t((()=>y($.b(),b.rootClass))),K=t((()=>f(b.rootStyle,{transform:`translate3d(0,${L.value}px,0)`,transitionDuration:(q.value?0:b.transitionDuration)+"ms"}))),O=t((()=>f({height:b.headerHeight+"px"}))),Q=t((()=>y($.e("loading"))));return(e,a)=>{const s=w;return r(),i(s,{class:c(J.value),style:m(K.value),onTouchstart:z,onTouchmove:A,onTouchend:G,onTouchcancel:G,onMousedown:N},{default:u((()=>[d(s,{class:c(v($).e("header")),style:m(O.value)},{default:u((()=>["unready"===E.value?p(e.$slots,"unready",{key:0,progress:M.value},(()=>[d(D,{type:"clock",class:c(Q.value),animated:!1,progress:M.value},null,8,["class","progress"])]),!0):"ready"===E.value?p(e.$slots,"ready",{key:1},(()=>[d(D,{type:"clock",class:c(Q.value),animated:!1},null,8,["class"])]),!0):"loading"===E.value?p(e.$slots,"loading",{key:2},(()=>[d(D,{type:"clock",class:c(Q.value)},null,8,["class"])]),!0):"done"===E.value?p(e.$slots,"done",{key:3},void 0,!0):h("",!0)])),_:3},8,["class","style"]),p(e.$slots,"default",{},void 0,!0)])),_:3},8,["class","style"])}}}),[["__scopeId","data-v-85f74cbb"]]);export{$ as _};
