import{E as e,d as a,G as l,p as o,g as t,A as s,L as n,o as u,f as i,w as d,e as r,h as v,u as c,x as m,T as y,c as p,F as f,b as h,z as w,i as _,t as b,q as x,l as k,M as g}from"./index-cDBoG4Q4.js";import{a as C,b as E,_ as T}from"./index.DPvFFOke.js";import{g as B,t as L}from"./dom.v6hFRhZS.js";import{a as j,u as z}from"./common.C5AqtFVf.js";const F=e.rate,H=T(a({options:{virtualHost:!0,styleIsolation:"shared"},__name:"rate",props:l({rootStyle:{},rootClass:{},modelValue:{},allowHalf:{type:Boolean},clearable:{type:Boolean},count:{},size:{},gap:{},iconFamily:{},icon:{},voidIcon:{},text:{},voidText:{},color:{},voidColor:{},disabled:{type:Boolean},readonly:{type:Boolean},validateEvent:{type:Boolean}},F),emits:["update:model-value"],setup(e,{emit:a}){const l=e,T=a,F=E("rate"),H=j(),I=z(),V=o((()=>(null==H?void 0:H.disabled)??l.disabled)),$=o((()=>(null==H?void 0:H.readonly)??l.readonly)),S=t(l.modelValue??0);s((()=>l.modelValue),(()=>{S.value=l.modelValue??0,l.validateEvent&&(null==I||I.onChange())}));const A=n(),M=n(),X=g(),q=t(),D=t(),G=o((()=>Array(l.count).fill(0).map(((e,a)=>{const l=a+1-S.value;return{width:100*(l<=0?1:l>1?0:S.value%1)+"%"}})))),P=()=>{$.value||V.value||(B(`#${A}`,X).then((e=>{q.value=e})),B(`#${M}`,X).then((e=>{D.value=e})))},J=e=>{if($.value||V.value)return;if(!q.value||!D.value)return;const{left:a,width:o}=q.value,{clientX:t}=e.touches[0],s=t-a;let n;if(s<0)n=0;else{const{width:e}=D.value,a=(o-l.count*e)/(l.count-1);for(let o=l.count-1;o>=0;o--){const t=o*(a+e);if(s>=t){n=o+(l.allowHalf&&s<=t+e/2?.5:1);break}}}void 0!==n&&n!==S.value&&(S.value=n,T("update:model-value",n))},K=()=>{P();const e=e=>{e.preventDefault(),e.stopPropagation(),J(L(e))},a=()=>{document.removeEventListener("mouseup",a),document.removeEventListener("mousemove",e)};document.addEventListener("mousemove",e),document.addEventListener("mouseup",a)},N=o((()=>x(F.b(),F.m("disabled",V.value),F.m("readonly",$.value),l.rootClass))),O=o((()=>w(l.rootStyle))),Q=o((()=>w({gap:l.gap})));return(e,a)=>{const o=k;return u(),i(o,{class:v(N.value),style:m(O.value)},{default:d((()=>[r(o,{class:v(c(F).e("content")),style:m(Q.value),id:c(A),onTouchstart:P,onTouchmove:y(J,["stop","prevent"]),onMousedown:K},{default:d((()=>[(u(!0),p(f,null,h(G.value,((a,t)=>(u(),i(o,{key:t,class:v(c(F).e("item")),id:0===t?c(M):void 0,style:m(c(w)({fontSize:e.size})),onClick:e=>(async(e,a)=>{if($.value||V.value)return;let o;if(l.allowHalf){const{left:t,width:s}=await B(`#${A}`,X),{width:n}=await B(`#${M}`,X),{clientX:u}="touches"in e?e.touches[0]:e;o=a+(u-t-a*(n+(s-l.count*n)/(l.count-1))<=n/2?.5:1)}else o=a+1;l.clearable&&o===S.value&&(o=0),void 0!==o&&o!==S.value&&(S.value=o,T("update:model-value",o))})(e,t)},{default:d((()=>[r(o,{class:v(c(F).e("star-void")),style:m(c(w)({color:e.voidColor}))},{default:d((()=>[e.voidText?(u(),p(f,{key:0},[_(b(e.voidText),1)],64)):(u(),i(C,{key:1,name:e.voidIcon,family:e.iconFamily},null,8,["name","family"]))])),_:1},8,["class","style"]),r(o,{class:v(c(F).e("star")),style:m(c(w)({color:e.color,width:a.width}))},{default:d((()=>[e.text?(u(),p(f,{key:0},[_(b(e.text),1)],64)):(u(),i(C,{key:1,name:e.icon,family:e.iconFamily},null,8,["name","family"]))])),_:2},1032,["class","style"])])),_:2},1032,["class","id","style","onClick"])))),128))])),_:1},8,["class","style","id"])])),_:1},8,["class","style"])}}}),[["__scopeId","data-v-a251e0e1"]]);export{H as _};
