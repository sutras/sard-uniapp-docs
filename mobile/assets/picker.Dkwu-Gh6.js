import{E as e,d as a,G as s,p as l,g as n,W as t,A as u,y as r,a5 as c,o,f as i,w as d,e as m,h as v,u as f,c as p,F as y,b as h,i as g,t as A,x as b,$ as _,a6 as k,q as x,z as V,l as j,a7 as w,a8 as C}from"./index-cDBoG4Q4.js";import{b as I,_ as M}from"./index.DPvFFOke.js";const K={...e.picker,columns:()=>[]},S={label:"label",value:"value",children:"children"};function q(e,a){const s=e[0];return Array.isArray(s)?"multi":s&&"object"==typeof s&&Array.isArray(s[a.children])?"cascader":"single"}function z(e,a){return null!==e&&"object"!=typeof e?e:e[a]}function B(e,a,s){switch(q(a,s)){case"single":return[a[e[0]]];case"multi":return a.map(((a,s)=>a[e[s]]));case"cascader":return function a(l,n=0){const t=l[Math.min(e[n],l.length-1)],u=null==t?void 0:t[s.children];return Array.isArray(u)?[t,...a(u,++n)]:[t]}(a)}}function E(e,a,s){const l=function(e,a){return e.map((e=>z(e,a)))}(e,a.value);return"single"===q(s,a)?l[0]:l}function F(e,a,s){const l=q(a,s);return"cascader"===l?function a(l,n=0){let t=l.findIndex((a=>a[s.value]===e[n]));-1===t&&(t=0);const u=l[t],r=null==u?void 0:u[s.children];return Array.isArray(r)?[t,...a(r,++n)]:[t]}(a):("single"===l&&(a=[a]),a.map(((a,l)=>{const n=a.findIndex((a=>z(a,s.value)===e[l]));return Math.max(n,0)})))}function G(e,a){switch(q(e,a)){case"single":return z(e[0],a.value);case"multi":return e.map((e=>z(e[0],a.value)));case"cascader":return z(function e(s){const l=s[0],n=null==l?void 0:l[a.children];return Array.isArray(n)&&n.length>0?e(n):l}(e),a.value)}}const H=M(a({options:{virtualHost:!0,styleIsolation:"shared"},__name:"picker",props:s({rootStyle:{},rootClass:{},columns:{},optionKeys:{},modelValue:{},immediateChange:{type:Boolean}},K),emits:["update:model-value"],setup(e,{emit:a}){const s=e,M=a,K=I("picker"),G=l((()=>Object.assign({},S,s.optionKeys))),H=l((()=>q(s.columns,G.value))),O=n(s.modelValue),W=n(F(t(O.value),s.columns,G.value));u((()=>s.modelValue),(()=>{if(O.value=s.modelValue,!r(s.modelValue)&&""!==s.modelValue){const e=F(t(s.modelValue),s.columns,G.value);c(e,W.value)||(W.value=e)}}));const $=e=>{let a=e.detail.value;if(a.some((e=>e===1/0)))return void _((()=>{W.value=r(O.value)||""===O.value?W.value.map((()=>0)):[...W.value]}));if("cascader"===H.value){let e=-1;const l=[];for(let s=0;s<W.value.length;s++)e<0&&W.value[s]!==a[s]&&(e=s),l.push(e>-1&&s>e?0:a[s]);a=l;{const e=function(e,a,s){return function a(l,n=0){let t=Math.min(e[n],l.length-1);const u=l[t];u||(t=0);const r=null==u?void 0:u[s.children];return Array.isArray(r)?[t,...a(r,++n)]:[t]}(a)}(a,s.columns,G.value);c(a,e)||(a=e)}}const l=B(a,s.columns,G.value);c(a,W.value)||(W.value=a);const n=E(l,G.value,s.columns);O.value=n,M("update:model-value",n,l,a)},D=()=>{switch(H.value){case"single":return[s.columns];case"multi":return s.columns;case"cascader":return k(s.columns,t(O.value),G.value);default:return[]}},J=n(D());u([()=>s.columns,O],(([e,a],[s,l])=>{(e!==s||a!==l&&"cascader"===H.value&&!r(a)&&""!==a&&(!Array.isArray(a)||a.length>0))&&(J.value=D())}));const L=e=>z(e,G.value.label),N=l((()=>x(K.b(),s.rootClass))),P=l((()=>V(s.rootStyle)));return(e,a)=>{const s=j,l=w,n=C;return o(),i(s,{class:v(N.value),style:b(P.value)},{default:d((()=>[m(n,{class:v(f(K).e("picker-view")),"indicator-class":f(K).e("indicator"),"mask-class":f(K).e("mask"),value:W.value,"immediate-change":e.immediateChange,onChange:$},{default:d((()=>[(o(!0),p(y,null,h(J.value,((e,a)=>(o(),i(l,{key:a},{default:d((()=>[(o(!0),p(y,null,h(e,((e,a)=>(o(),i(s,{key:a,class:v(f(K).e("item"))},{default:d((()=>[g(A(L(e)),1)])),_:2},1032,["class"])))),128))])),_:2},1024)))),128))])),_:1},8,["class","indicator-class","mask-class","value","immediate-change"])])),_:1},8,["class","style"])}}}),[["__scopeId","data-v-772c1bfe"]]);export{H as _,F as a,B as b,z as c,S as d,G as g,K as p};
